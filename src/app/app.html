<!-- NAVBAR (cachée sur /login et /register) -->
<nav class="navbar" *ngIf="showNavbar">
  <div class="navbar-left">
    <a routerLink="/" class="brand">Enoch Leathercraft</a>
  </div>

  <div class="navbar-right">
    <!-- Lien panier -->
    <a
      routerLink="/cart"
      class="cart-link"
      (mouseenter)="onCartEnter()"
      (mouseleave)="onCartLeave()"
    >
      <i class="fa-solid fa-shopping-bag"></i>
      <span>Panier</span>
      <span class="cart-badge">{{ cart.totalQuantity || 0 }}</span>
    </a>

    <!-- Lien profil (visible seulement connecté) -->
    <a
      *ngIf="isLoggedIn"
      routerLink="/profile"
      class="profile-link"
    >
      <i class="fa-solid fa-user"></i>
      <span>Mon compte</span>
    </a>

    <!-- Bouton déconnexion -->
    <button
      class="logout-btn"
      *ngIf="isLoggedIn"
      (click)="onLogout()"
    >
      <i class="fa-solid fa-right-from-bracket"></i>
      <span>Déconnexion</span>
    </button>
  </div>
</nav>

<!-- MINI APERÇU PANIER (hover sur le lien panier ou sur lui-même) -->
<div
  class="mini-cart"
  *ngIf="showMiniCart"
  (mouseenter)="onCartEnter()"
  (mouseleave)="onCartLeave()"
>
  <h3>Votre panier</h3>

  <ng-container *ngIf="cart.items && cart.items.length; else emptyMiniCart">
    <ul class="mini-cart-list">
      <li *ngFor="let item of cart.items | slice:0:3">
        <div class="mini-cart-item-name">
          {{ item.name }}
        </div>
        <div class="mini-cart-item-info">
          <span>x{{ item.quantity }}</span>
          <span class="line-total">
            {{ item.lineTotal | currency:'EUR' }}
          </span>
        </div>
      </li>
    </ul>

    <div class="mini-cart-footer">
      <div class="mini-cart-total">
        Total : <strong>{{ cart.totalAmount | currency:'EUR' }}</strong>
      </div>
      <a routerLink="/cart" class="mini-cart-button">
        Voir le panier
      </a>
    </div>
  </ng-container>

  <ng-template #emptyMiniCart>
    <p class="mini-cart-empty">Votre panier est vide.</p>
  </ng-template>
</div>

<!-- CONTENU DES PAGES -->
<router-outlet></router-outlet>

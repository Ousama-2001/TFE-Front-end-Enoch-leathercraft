<div class="account">
  <h1>{{ 'account.title' | t }}</h1>

  <!-- TABS -->
  <div class="tabs">
    <button [class.active]="activeTab === 'profile'" (click)="switchTab('profile')">
      {{ 'account.tabs.profile' | t }}
    </button>
    <button [class.active]="activeTab === 'address'" (click)="switchTab('address')">
      {{ 'account.tabs.address' | t }}
    </button>
    <button [class.active]="activeTab === 'orders'" (click)="switchTab('orders')">
      {{ 'account.tabs.orders' | t }}
    </button>
    <button [class.active]="activeTab === 'security'" (click)="switchTab('security')">
      {{ 'account.tabs.security' | t }}
    </button>
  </div>

  <!-- ALERTS (venant du TS) -->
  <p *ngIf="error" class="alert error">{{ error }}</p>
  <p *ngIf="success" class="alert success">{{ success }}</p>

  <!-- PROFIL -->
  <div *ngIf="activeTab === 'profile'" class="card">
    <h2>{{ 'account.profile.title' | t }}</h2>

    <form (ngSubmit)="saveProfile()">
      <div class="grid">
        <label>
          {{ 'account.profile.firstName' | t }} :
          <input [(ngModel)]="profile.firstName" name="first" />
        </label>

        <label>
          {{ 'account.profile.lastName' | t }} :
          <input [(ngModel)]="profile.lastName" name="last" />
        </label>

        <label>
          {{ 'account.profile.email' | t }} :
          <input [value]="profile.email" disabled />
        </label>

        <label>
          {{ 'account.profile.phone' | t }} :
          <input [(ngModel)]="profile.phone" name="phone" />
        </label>
      </div>

      <button class="btn" [disabled]="savingProfile">
        {{ savingProfile ? ('account.profile.saving' | t) : ('account.profile.save' | t) }}
      </button>
    </form>
  </div>

  <!-- ADRESSE -->
  <div *ngIf="activeTab === 'address'" class="card">
    <h2>{{ 'account.address.title' | t }}</h2>

    <form (ngSubmit)="saveProfile()">
      <div class="grid">
        <label>
          {{ 'account.address.address' | t }} :
          <input [(ngModel)]="profile.addressLine1" name="address" />
        </label>

        <label>
          {{ 'account.address.postalCode' | t }} :
          <input [(ngModel)]="profile.postalCode" name="postalCode" />
        </label>

        <label>
          {{ 'account.address.city' | t }} :
          <input [(ngModel)]="profile.city" name="city" />
        </label>

        <label>
          {{ 'account.address.country' | t }} :
          <input [(ngModel)]="profile.country" name="country" />
        </label>
      </div>

      <button class="btn" [disabled]="savingProfile">
        {{ savingProfile ? ('account.address.saving' | t) : ('account.address.save' | t) }}
      </button>
    </form>
  </div>

  <!-- COMMANDES -->
  <div *ngIf="activeTab === 'orders'" class="card">
    <h2>{{ 'account.orders.title' | t }}</h2>

    <p *ngIf="loadingOrders">{{ 'account.orders.loading' | t }}</p>

    <table *ngIf="!loadingOrders && myOrders.length" class="orders">
      <thead>
      <tr>
        <th>{{ 'account.orders.ref' | t }}</th>
        <th>{{ 'account.orders.date' | t }}</th>
        <th>{{ 'account.orders.total' | t }}</th>
        <th>{{ 'account.orders.status' | t }}</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let o of myOrders">
        <td>{{ o.reference }}</td>
        <td>{{ o.createdAt | date:'dd/MM/yy HH:mm' }}</td>
        <td>{{ o.totalAmount | currency:'EUR' }}</td>
        <td>{{ o.status }}</td>
      </tr>
      </tbody>
    </table>

    <p *ngIf="!loadingOrders && !myOrders.length">
      {{ 'account.orders.empty' | t }}
    </p>
  </div>

  <!-- SÉCURITÉ -->
  <div *ngIf="activeTab === 'security'" class="card">
    <h2>{{ 'account.security.title' | t }}</h2>

    <form (submit)="submitPasswordChange()">
      <label>
        {{ 'account.security.oldPassword' | t }} :
        <input type="password" [(ngModel)]="oldPassword" name="old" />
      </label>

      <label>
        {{ 'account.security.newPassword' | t }} :
        <input type="password" [(ngModel)]="newPassword" name="new" />
      </label>

      <label>
        {{ 'account.security.confirm' | t }} :
        <input type="password" [(ngModel)]="confirmPassword" name="confirm" />
      </label>

      <button class="btn" [disabled]="changingPassword">
        {{
          changingPassword
            ? ('account.security.changing' | t)
            : ('account.security.change' | t)
        }}
      </button>
    </form>
  </div>
</div>

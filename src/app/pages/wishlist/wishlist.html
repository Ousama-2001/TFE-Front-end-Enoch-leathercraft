<div class="wishlist-page">
  <div class="wishlist-inner">
    <div class="wishlist-header">
      <h1>{{ 'wishlist.title' | t }}</h1>
      <p class="subtitle">
        {{ 'wishlist.subtitle' | t }}
      </p>
    </div>

    <div *ngIf="loading" class="wishlist-loading">
      {{ 'wishlist.loading' | t }}
    </div>

    <div *ngIf="!loading && error" class="wishlist-empty">
      {{ error }}
    </div>

    <div
      *ngIf="!loading && !error && items.length === 0"
      class="wishlist-empty"
    >
      {{ 'wishlist.empty' | t }}
      <br>
      <a routerLink="/products">{{ 'wishlist.empty.backToShop' | t }}</a>
    </div>

    <div class="wishlist-actions" *ngIf="items.length > 0">
      <button class="btn-clear" (click)="clearWishlist()">
        {{ 'wishlist.actions.clear' | t }}
      </button>
    </div>

    <div
      class="wishlist-grid"
      *ngIf="!loading && !error && items.length > 0"
    >
      <article class="wishlist-card" *ngFor="let w of paginatedItems">
        <div
          class="wishlist-card-image"
          (click)="goToProduct(w.product.id)"
        >
          <img
            [src]="getProductImageUrl(w)"
            [alt]="w.product.name || 'Produit Enoch Leathercraft'"
          />
        </div>

        <div class="wishlist-card-body">
          <h3 class="wishlist-product-name">
            {{ w.product.name }}
          </h3>

          <p class="wishlist-product-price">
            {{ w.product.price | currency : 'EUR' }}
          </p>
        </div>

        <div class="wishlist-card-footer">
          <button
            type="button"
            class="wishlist-remove-btn"
            (click)="remove(w.product.id)"
          >
            {{ 'wishlist.actions.remove' | t }}
          </button>

          <button
            type="button"
            class="wishlist-add-cart-btn"
            (click)="addToCart(w)"
            [disabled]="isAddDisabled(w)"
          >
            {{ 'product.addToCart' | t }}
          </button>
        </div>

        <p class="wishlist-stock-warning" *ngIf="isMaxQuantityReached(w)">
          {{ 'products.stock.maxReached' | t }}
        </p>
      </article>
    </div>

    <div
      class="wishlist-pagination"
      *ngIf="!loading && !error && items.length > pageSize"
    >
      <button
        class="wishlist-page-btn"
        [disabled]="page === 1"
        (click)="changePage(page - 1)"
      >
        {{ 'products.pagination.prev' | t }}
      </button>

      <span class="wishlist-page-info">
        {{ 'products.pagination.pageInfo' | t }} {{ page }} / {{ totalPages }}
      </span>

      <button
        class="wishlist-page-btn"
        [disabled]="page === totalPages"
        (click)="changePage(page + 1)"
      >
        {{ 'products.pagination.next' | t }}
      </button>
    </div>
  </div>
</div>

<div class="products-page">
  <!-- Bandeau titre -->
  <section class="hero">
    <h1>Enoch Leathercraft</h1>
    <p>Découvrez nos sacs, sacoches, ceintures et portefeuilles faits main.</p>
  </section>

  <!-- SECTION PRODUITS -->
  <section
    class="products-section"
    *ngIf="products && products.length; else noProducts"
  >
    <h2 class="section-title">Nos produits</h2>

    <div class="products-grid">
      <article class="product-card" *ngFor="let p of paginatedProducts">
        <div class="product-image">
          <img src="assets/img/products/placeholder-bag.jpg" [alt]="p.name" />
        </div>

        <div class="product-body">
          <h3 class="product-name">{{ p.name }}</h3>

          <p class="product-description" *ngIf="p.description; else noDesc">
            {{ p.description }}
          </p>
          <ng-template #noDesc>
            <p class="product-description muted">
              Description à venir.
            </p>
          </ng-template>

          <!-- ✅ Footer propre : prix + actions -->
          <div class="product-footer">
            <div class="price">
              {{ p.price | currency:'EUR' }}
            </div>

            <div class="product-actions">
              <!-- Si le produit n'est pas encore dans le panier -->
              <ng-container *ngIf="getQuantity(p) === 0; else qtyControls">
                <button
                  type="button"
                  class="btn-add-cart"
                  (click)="increase(p)"
                >
                  Ajouter au panier
                </button>
              </ng-container>

              <!-- Si le produit est déjà dans le panier -->
              <ng-template #qtyControls>
                <div class="qty-pill">
                  <button type="button" (click)="decrease(p)">−</button>
                  <span>{{ getQuantity(p) }}</span>
                  <button type="button" (click)="increase(p)">+</button>
                </div>
              </ng-template>

              <button
                type="button"
                class="btn-primary"
                [routerLink]="['/products', p.id]"
              >
                Voir le produit
              </button>
            </div>
          </div>
        </div>
      </article>
    </div>

    <!-- PAGINATION -->
    <div class="pagination" *ngIf="totalPages > 1">
      <button
        class="page-btn"
        [disabled]="page === 1"
        (click)="changePage(page - 1)"
      >
        ← Précédent
      </button>

      <span class="page-info">
        Page {{ page }} / {{ totalPages }}
      </span>

      <button
        class="page-btn"
        [disabled]="page === totalPages"
        (click)="changePage(page + 1)"
      >
        Suivant →
      </button>
    </div>
  </section>

  <ng-template #noProducts>
    <p class="empty-message">Aucun produit disponible pour le moment.</p>
  </ng-template>
</div>
